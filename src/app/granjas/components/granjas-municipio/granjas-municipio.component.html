<div>
  <div class="data-container">
    <div class="data-container__div">
      <div class="container">
        <img class="container__icon" src="assets/icons/build.svg">
        <div class="container__info">
          <h3 class="container__title container__title--color-blue">Municipio</h3>
          <span class="container__description">{{municipio}}</span>
        </div>
      </div>
      <div class="container">
        <img class="container__icon" src="assets/icons/group-circle-solid.svg">
        <div class="container__info">
          <h3 class="container__title container__title--color-morado">Población</h3>
          <span class="container__description">{{poblacion | number:'':'es'}}</span>
        </div>
      </div>
      <div class="container">
        <img class="container__icon" src="assets/icons/fish.svg">
        <div class="container__info">
          <h3 class="container__title container__title--color-blue-2">Granjas</h3>
          <span class="container__description">{{granjas.length}}</span>
        </div>
      </div>
    </div>
  </div>
  <div class="buscadoryfiltro" *ngIf="granjas.length > 0">
    <div class="buscador-container">
      <app-search class="buscador-container__search" [buscadorpersonalizado]="true" [placeholderbuscador]="'Buscar granjas...'"
        (keyEnterPressData)="onBuscarPalabra($event)">
      </app-search>
      <app-filtro
      [filtro]="filtro"
      [checkboxfiltro]="false"
      (onFilterSeleccionado)="onFiltroChange($event)"
      [filtroSeleccionado]="filtroseleccionado">
      </app-filtro>
      </div>
      <div class="chip">
        <app-chip-con-boton-close
        *ngIf="filtroseleccionado"
          [iconoChip]="true"
          [imgIconoChip]="'assets/icons/filter_alt_black_24dp.svg'"
           [contenidoChip]="filtroseleccionado.nombrefiltro"
          (onCloseClip)="delateFilter()">
        </app-chip-con-boton-close>
      </div>
  </div>
  <div class="search-container" *ngIf="showNotFound">
    <div class="search-container__box">
      <img class="search-container__image" [ngClass]="{'search-container__image--modify':granjas.length<1}" src="assets/images/searching.svg">
      <h3>No se han encontrado resultados</h3>
      <p>No encontramos resultados para esta busqueda </p>
      <button class="btn-rounded btn--blue" (click)="goBack()">Volver al mapa</button>
    </div>
  </div>
  <div>
    <div class="container-map-car">
      <div class="row-map-cart">
        <div *ngIf="granjasFiltered.length >= 1">
          <div class="blog-card" *ngFor="let granja of granjasFiltered ; let i =index" (mouseover)="onMouseCard(i)"
            (mouseout)="eliminInfoWindow()">
            <div class="meta">
              <div class="photo">
                <app-carrucel-img
                   class="card__image"
                   [imagenes]="granjasFiltered[i].fotos"
                  [indicatorsphoto]=" indicatorsphotos"
                  [idtarge]="i"
                  (eventValueResponseClickFotoMiniSlider)="navigate(granja.id_granja)"
                  (eventValueResponseClickDivIndicadorSlider)="navigate(granja.id_granja)"
                  (eventValueResponseclickImagenItemSlider)="navigate(granja.id_granja)">
                </app-carrucel-img>
              </div>
            </div>
            <div class="description">
              <div class="description_title_fauvourite">
                <div>
                  <h1 class="description_title_fauvourite--h1" (click)="navigate(granja.id_granja)">{{granja.nombre |
                    shorter:shorterNumber}}</h1>
                </div>
                <img class="card__icon-favorite" src="assets/icons/heart-filled.svg" *ngIf="granja?.favorita"
                  (click)="changeFavorite(i)">
                <img class="card__icon-favorite" src="assets/icons/heart-outline.svg" *ngIf="!granja?.favorita"
                  (click)="changeFavorite(i)">
              </div>
              <div class="mas_description_info" (click)="navigate(granja.id_granja)">
                <p class="estilo-p-card" (click)="navigate(granja.id_granja)"> {{granja.descripcion | shorter:80}}</p>
              </div>
              <div class="card__rating-container">
                <div class="card__rating-container_info">
                  <div><span class="card__rating">Área: </span>{{granja?.area}} m²</div>
                  <div class="card__rating-container_puntos" (click)="showResenas(granja?.id_granja)">
                    <app-stars [selectedStar]="granja?.puntuacion" size="mini"></app-stars>
                  </div>
                  <div class="card__rating__detail" (click)="showResenas(granja?.id_granja)">
                    <span class="card__rating">Reseñas:</span> {{granja.count_resenas}}
                  </div>
                </div>
                <p class="read-more">
                  <img class="photo--verMapa" src="assets/icons/location24dp.svg" (click)="seeFarmsMaptwo(i)">
                  <a (click)="navigate(granja.id_granja)">Detalles</a>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="mYstiledivmap">
        <div class="sticky-top">
          <div class="mapgoogle" *ngIf="granjasFiltered.length > 0 && (apiLoaded | async)">
            <google-map   width="100%" height="100%" class="mapa__estilos"  [options]="options"
               (tilesloaded)="mapainiciado()">
              <map-marker #marker="mapMarker" *ngFor="let markerInfo of markersInfo  ; let i =index"
                [position]="markerInfo.markerPosition" [options]="markerOptions"
                icon="{{ i == indexSelected ? 'assets/icons/fish-marker-red.svg' : 'assets/icons/fish-marker.svg' }}"
                (mapMouseover)="openInfoWindow(marker,i)"
                (mapMouseout)="eliminInfoWindow()"
                (mapClick)="openInfoWindowClick(marker,i)"
                 >
              </map-marker>
              <map-polyline [path]="vertices" [options]="optionPoli"></map-polyline>
              <map-info-window [position]="markerPosition" *ngIf="mapaOn">
                <div class="myestilo-map-info-window">
                  <div class="details_info_windo">
                    <div class="detais-name-propietario_info_windo ">
                      <div> <img src="assets/icons/person_black.svg"></div>
                      <div>{{selectedGranja.propietario.nombre | titlecase }}</div>
                    </div>
                    <div class="details-area-nombre-granja_info_windo ">
                      <div><img src="assets/icons/set_meal_black_24dp.svg"></div>
                      <div> {{selectedGranja.nombregranja | titlecase}}</div>
                    </div>
                    <div class="details-area-direccion_info_windo ">
                      <div><img src="assets/icons/location_on_black_24dp.svg"></div>
                      <div *ngIf="!selectedGranja.dirreciongranja">Dirección indefinida</div>
                      <div *ngIf="selectedGranja.dirreciongranja">{{selectedGranja.dirreciongranja}}</div>
                    </div>
                  </div>
                </div>
              </map-info-window>
            </google-map>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
