<div class="container">
  <div class="container-table-pagination">
    <table class="table mt-40">
        <thead class="table-light micolortablelight">
          <tr>
            <th>Imagen</th>
            <th>Nombre de producto</th>
            <th>Descripción</th>
            <th>Precio</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let producto of productos |  paginate: { itemsPerPage: 3, currentPage: p }; let i=index">
            <td class="imgproductotd"><img class="container_img" [src]="producto.imagen"></td>
            <td class="colortextoproducto">{{producto.nombreProducto}}</td>
            <td class="colortextoproducto">{{producto.descripcion}}</td>
            <td class="colortextoproducto">{{producto.precio}}</td>
            <td>
                <div class="container-row">
                    <i class="container__icon bi bi-pencil text-success me-3 mitextcolorpencil" (click)="openModal(content,'update',i)"></i>
                    <i class="container__icon bi bi-trash text-danger mitextcolortrash" (click)="deleteProducto(producto.codigo,i)"></i>
                </div>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- https://www.npmjs.com/package/ngx-pagination -->
      <pagination-controls
                         *ngIf="!showNotFound"
                          class="my-paginationn"
                         (pageChange)="p = $event"
                          previousLabel="Anterior"
                          nextLabel="Siguiente"
      ></pagination-controls>
  </div>
  <button class="btn-outline-blue button" (click)="openModal(content,'create')">Agregar nuevo producto</button>
</div>
<div class="search-container" *ngIf="showNotFound">
  <div class="search-container__box">
      <img class="search-container__image" src="assets/images/searching.svg">
      <h3>No se han encontrado resultados</h3>
      <p>Aun no has registrado los productos que vendes.</p>
  </div>
</div>

<ng-template #content let-modal>
  <div class="modal-header">
    <h4 class="modal-title modalmytitle" id="modal-basic-title">{{modalMode == 'create' ? 'Nuevo Producto' : 'Actualizar Producto'}}</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <form [formGroup]="form">
      <div class="mb-3">
        <label for="dateOfBirth">Nombre</label>
        <div class="input-group">
          <input id="productName" class="form-control" placeholder="Nombre" formControlName="nombreProducto">
          <!-- <button class="btn btn-outline-secondary" type="button"></button> -->
        </div>
        <div *ngIf="invalid('nombreProducto')" class="container__alert-msg danger-message">
          <div *ngIf="nombreProducto?.errors?.['required']">
              Campo requerido
          </div>
        </div>
      </div>
      <div class="mb-3">
        <label for="dateOfBirth">Descripción</label>
        <div class="input-group">
          <input id="productName" class="form-control" placeholder="Descripción" formControlName="descripcion">
          <!-- <button class="btn btn-outline-secondary" type="button"></button> -->
        </div>
        <div *ngIf="invalid('descripcion')" class="container__alert-msg danger-message">
          <div *ngIf="descripcion?.errors?.['required']">
              Campo requerido
          </div>
        </div>
      </div>
      <div class="mb-3">
        <label for="dateOfBirth">Imagen</label>
        <div class="input-group">
          <input id="productName" type="file" class="form-control" placeholder="Seleccione una imagen" (change)='fileChange($event)' formControlName="imagen">
          <!-- <button class="btn btn-outline-secondary" type="button"></button> -->
        </div>
        <div *ngIf="showErrorNotImageSelected" class="container__alert-msg danger-message">
          <div *ngIf="showErrorNotImageSelected">
              Campo requerido
          </div>
        </div>
      </div>

      <div class="mb-3">
        <img class="modal__image" [src]="previewImage" *ngIf="previewImage">
      </div>

      <div class="mb-3">
        <label for="dateOfBirth">Precio</label>
        <div class="input-group">
          <input id="productName" type="number" class="form-control" placeholder="Ej. 50000" formControlName="precio">
          <!-- <button class="btn btn-outline-secondary" type="button"></button> -->
        </div>
        <div *ngIf="invalid('precio')" class="container__alert-msg danger-message">
          <div *ngIf="precio?.errors?.['required']">
              Campo requerido
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark container__btn" (click)="addProducto()" *ngIf="modalMode=='create'">
      <span *ngIf="!loading">Guardar</span>
      <div class="container__spinner spinner-border text-danger" role="status" *ngIf="loading">
      </div>
    </button>
    <button type="button" class="btn btn-outline-dark container__btn" (click)="updateProducto()" *ngIf="modalMode=='update'">
      <span *ngIf="!loading">Actualizar</span>
      <div class="container__spinner spinner-border text-danger mitexcolor" role="status" *ngIf="loading">
      </div>
    </button>
  </div>
</ng-template>
